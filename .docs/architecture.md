# cli-mcp 아키텍처

## 개요

cli-mcp는 MCP (Model Context Protocol) 서버 관리를 위한 현대적인 Python CLI 도구입니다. 이 문서는 프로젝트의 전체적인 아키텍처와 설계 결정사항을 설명합니다.

## 프로젝트 구조

```
cli-mcp/
├── src/cli_mcp/              # 메인 소스 코드
│   ├── cli.py               # CLI 진입점 (Typer 기반)
│   ├── commands/            # CLI 명령어 모듈
│   └── servers/             # MCP 서버 구현
│       ├── example/         # 예시 MCP 서버
│       └── ...             # 추가 MCP 서버들
├── tests/                   # 테스트 코드
├── config/                  # 설정 파일들
└── .github/workflows/       # CI/CD 파이프라인
```

## 핵심 컴포넌트

### 1. CLI 인터페이스
- **Typer 프레임워크**: 타입 힌트 기반의 현대적인 CLI 구축
- **함수형 프로그래밍**: 순수 함수와 고차 함수를 활용한 구현
- **명령어 구조**: 서브커맨드를 통한 확장 가능한 구조

### 2. MCP 서버 관리
- **서버 디스커버리**: 설치된 MCP 서버 자동 탐색
- **서버 실행**: stdio, HTTP/SSE 등 다양한 전송 방식 지원
- **서버 설정**: 각 서버별 설정 파일 관리

### 3. 플러그인 시스템
- **동적 로딩**: Python 모듈로서 MCP 서버 동적 로드
- **인터페이스 표준화**: 공통 MCP 서버 인터페이스 정의
- **확장성**: 새로운 MCP 서버 쉽게 추가 가능

## 설계 원칙

### 1. 단순성 (Simplicity)
- 오캄의 면도날 원칙 적용
- 필요 이상으로 복잡하지 않은 설계
- 명확하고 이해하기 쉬운 코드

### 2. 테스트 가능성 (Testability)
- 90% 이상의 테스트 커버리지 유지
- 의존성 주입을 통한 테스트 용이성
- 단위 테스트와 통합 테스트 분리

### 3. 확장성 (Extensibility)
- 새로운 MCP 서버 추가 용이
- 플러그인 아키텍처
- 명확한 인터페이스 정의

## MCP 프로토콜 지원

### 전송 방식
1. **stdio**: 표준 입출력을 통한 통신
2. **HTTP/SSE**: Server-Sent Events를 활용한 웹 기반 통신

### 메시지 포맷
- JSON-RPC 2.0 프로토콜 준수
- 요청/응답 패턴
- 비동기 알림 지원

## 보안 고려사항

1. **입력 검증**: 모든 사용자 입력 철저히 검증
2. **권한 관리**: 서버 실행 권한 제어
3. **설정 보호**: 민감한 설정 정보 안전하게 관리

## 성능 최적화

1. **지연 로딩**: 필요한 모듈만 동적으로 로드
2. **캐싱**: 서버 메타데이터 캐싱
3. **비동기 처리**: 가능한 경우 비동기 I/O 활용

## 향후 계획

1. **웹 UI**: MCP 서버 관리를 위한 웹 인터페이스
2. **모니터링**: 실행 중인 서버 상태 모니터링
3. **서버 레지스트리**: 공식 MCP 서버 레지스트리 통합
